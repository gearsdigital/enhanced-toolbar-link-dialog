(function(){"use strict";const m="";function d(e,t,a,i,r,o,u,v){var n=typeof e=="function"?e.options:e;t&&(n.render=t,n.staticRenderFns=a,n._compiled=!0),i&&(n.functional=!0),o&&(n._scopeId="data-v-"+o);var s;if(u?(s=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__<"u"&&(l=__VUE_SSR_CONTEXT__),r&&r.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(u)},n._ssrRegister=s):r&&(s=v?function(){r.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(n.functional){n._injectStyles=s;var _=n.render;n.render=function($,c){return s.call(c),_($,c)}}else{var h=n.beforeCreate;n.beforeCreate=h?[].concat(h,s):[s]}return{exports:e,options:n}}const g={data(){return{tabs:[{name:"external",label:this.$t("gearsdigital.enhanced-toolbar-link-dialog.external")},{name:"internal",label:this.$t("gearsdigital.enhanced-toolbar-link-dialog.internal")}],search:null,currentPage:{},currentTab:{},pages:[],value:{url:null,text:null},pagination:{page:1,total:0},externalFields:{url:{label:this.$t("link"),type:"text",placeholder:this.$t("url.placeholder"),icon:"url"},text:{label:this.$t("link.text"),type:"text"}},attributeFields:{selectedLinkTarget:{label:this.$t("gearsdigital.enhanced-toolbar-link-dialog.target.title"),type:"select",options:[{value:"_blank",text:this.$t("gearsdigital.enhanced-toolbar-link-dialog.target.blank")},{value:"_self",text:this.$t("gearsdigital.enhanced-toolbar-link-dialog.target.self")},{value:"_parent",text:this.$t("gearsdigital.enhanced-toolbar-link-dialog.target.parent")},{value:"_top",text:this.$t("gearsdigital.enhanced-toolbar-link-dialog.target.top")}],help:this.$t("gearsdigital.enhanced-toolbar-link-dialog.target.help")},title:{label:this.$t("gearsdigital.enhanced-toolbar-link-dialog.title.title"),type:"text"},anchor:{label:this.$t("gearsdigital.enhanced-toolbar-link-dialog.anchor.title"),type:"text"}},attributes:{selectedLinkTarget:null,title:null,anchor:null},showAvanced:!1}},computed:{hasPages(){return this.pages.length},kirbytext(){return this.$config.kirbytext},urlWithAnchor(){return this.attributes.anchor?this.value.url+"#"+this.attributes.anchor:this.value.url}},watch:{search:function(e,t){e!==t&&(this.pagination.page=0,this.fetch())}},methods:{open(e,t){const a=parseInt(this.$t("gearsdigital.enhanced-toolbar-link-dialog.tab.order"),10)||0;this.value.text=t,this.currentTab=this.tabs[a],this.$refs.dialog.open()},resetForm(){this.value={url:null,text:null},this.value.text=null,this.search=null,this.pagination.page=1,this.attributes={selectedLinkTarget:null,title:null,anchor:null}},selectTab(e){this.currentTab=e},selectPage(e){this.value={url:e.slug,text:this.value.text||e.title},this.isCurrentPage(e)?(this.currentPage={},this.value={url:null,text:null}):this.currentPage=e},isCurrentPage(e){return this.currentPage===e},paginate(e){this.pagination.page=e.page,this.fetch()},createKirbytext(){const e=[];return e.push(`link: ${this.urlWithAnchor}`),e.push(`text: ${this.value.text}`),this.attributes.selectedLinkTarget&&e.push(`target: ${this.attributes.selectedLinkTarget}`),this.attributes.title&&e.push(`title: ${this.attributes.title}`),this.value.url.indexOf("http")===0&&e.push("rel: nofollow"),`(${e.join(" ")})`},createMarkdown(){return this.value.text.length>0?`[${this.value.text}](${this.value.url})`:`<${this.value.url}>`},fetch(){const e={page:this.pagination.page,search:this.search};this.$api.get("enhanced-toolbar-link-dialog/pages",e).then(t=>{this.pages=t.data,this.pagination=t.pagination})},submit(){if(this.value.url===null){this.$refs.dialog.close();return}this.$emit("submit",this.kirbytext?this.createKirbytext():this.createMarkdown()),this.$refs.dialog.close()},toogleAvanced(){this.showAvanced=!this.showAvanced}}};var p=function(){var t=this,a=t._self._c;return a("k-dialog",{ref:"dialog",staticClass:"k-pages-dialog enhanced-toolbar",attrs:{button:t.$t("insert"),size:"medium"},on:{submit:t.submit,open:t.fetch,close:t.resetForm}},[a("div",{staticClass:"k-header"},[t.tabs&&t.tabs.length>1?a("div",{staticClass:"k-tabs"},[a("nav",t._l(t.tabs,function(i){return a("k-button",{key:i.name,staticClass:"k-tab-button",attrs:{current:t.currentTab&&t.currentTab.name===i.name},on:{click:function(r){return t.selectTab(i)}}},[t._v(" "+t._s(i.label)+" ")])}),1)]):t._e()]),t.currentTab.name==="external"?a("div",{staticClass:"k-tab"},[a("k-form",{ref:"form",attrs:{fields:t.externalFields},on:{submit:t.submit},model:{value:t.value,callback:function(i){t.value=i},expression:"value"}})],1):t._e(),t.currentTab.name==="internal"?a("div",{staticClass:"k-tab"},[a("k-input",{staticClass:"k-dialog-search",attrs:{autofocus:"true",placeholder:t.$t("search")+" \u2026",type:"text",icon:"search"},model:{value:t.search,callback:function(i){t.search=i},expression:"search"}}),t.hasPages?a("div",[t._l(t.pages,function(i){return a("k-item",{key:i.id,attrs:{text:i.title,layout:"list"},on:{click:function(r){return t.selectPage(i)}}},[a("template",{slot:"options"},[t.isCurrentPage(i)?a("k-button",{attrs:{slot:"options",autofocus:"true",icon:"check",theme:"positive",tooltip:t.$t("remove")},slot:"options"}):a("k-button",{attrs:{slot:"options",autofocus:"true",icon:"circle-outline",tooltip:t.$t("select")},slot:"options"})],1)],2)}),a("k-pagination",t._b({staticClass:"k-dialog-pagination",attrs:{details:!0,dropdown:!1,align:"center"},on:{paginate:t.paginate}},"k-pagination",t.pagination,!1)),a("k-line-field"),a("label",{staticClass:"k-toggle-input enhanced-toolbar-advanced"},[a("input",{staticClass:"k-toggle-input-native",attrs:{type:"checkbox"},on:{change:t.toogleAvanced}}),a("span",{staticClass:"k-toggle-input-label"},[t._v(" "+t._s(t.$t("gearsdigital.enhanced-toolbar-link-dialog.advanced"))+" ")])]),t.showAvanced?a("k-form",{attrs:{fields:t.attributeFields},model:{value:t.attributes,callback:function(i){t.attributes=i},expression:"attributes"}}):t._e()],2):a("k-text",[t._v(" "+t._s(t.$t("gearsdigital.enhanced-toolbar-link-dialog.empty"))+" ")])],1):t._e()])},b=[],f=d(g,p,b,!1,null,null,null,null);const k=f.exports;panel.plugin("gearsdigital/enhanced-toolbar-link-dialog",{components:{"k-toolbar-link-dialog":{extends:k}}})})();
